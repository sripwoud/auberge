---
- name: Setup Vibecoder VPS
  hosts: all
  become: true
  vars:
    user_name: "{{ ansible_user | default(ansible_ssh_user) }}"
    user_home: "/home/{{ ansible_user | default(ansible_ssh_user) }}"
    ssh_port: "{{ ansible_port | default(22) }}"

  roles:
    - vibecoder

  post_tasks:
    - name: Display setup summary
      ansible.builtin.debug:
        msg:
          - "==================================="
          - "Vibecoder Setup Complete!"
          - "==================================="
          - "User: {{ user_name }}"
          - "SSH Port: {{ ssh_port }}"
          - "Tailscale: {{ 'Configured' if tailscale_authkey else 'Manual setup required' }}"
          - "Telegram: {{ 'Enabled' if claude_code_remote_enable_telegram | default(false) else 'Disabled' }}"
          - ""
          - "Next steps:"
          - "1. SSH to your server: ssh {{ user_name }}@YOUR_IP -p {{ ssh_port }}"
          - "2. If Tailscale not configured: tailscale up --authkey=YOUR_KEY"
          - "3. Start Claude: tmux new -s claude && claude"
